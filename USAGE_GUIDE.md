# 📊 Stone量化交易系统 - 数据下载与策略回测指南

## 🎯 概述

本指南将帮助你：
1. 下载沪A股票的历史数据
2. 使用历史数据进行策略回测
3. 优化策略参数
4. 分析回测结果

## 📥 第一步：下载历史数据

### 1.1 使用数据下载器

运行数据下载脚本：

```bash
python data_downloader.py
```

### 1.2 下载选项

#### 选项1：下载单只股票数据
- 输入股票代码（如：000001）
- 选择下载月数（建议6-12个月）
- 系统会自动下载并保存到数据库

#### 选项2：批量下载热门股票
- 系统会下载预设的热门股票列表
- 包括银行股、科技股、指数ETF等
- 适合初次使用者

#### 选项3：自定义股票列表
- 输入多个股票代码，用逗号分隔
- 例如：000001,600036,000858
- 批量下载指定股票的数据

#### 选项4：检查数据覆盖
- 查看已下载的股票数据情况
- 确认数据的时间范围和完整性

### 1.3 推荐的股票代码

**银行股：**
- 600036 (招商银行)
- 000001 (平安银行)
- 600000 (浦发银行)
- 601166 (兴业银行)

**消费股：**
- 600519 (贵州茅台)
- 000858 (五粮液)

**科技股：**
- 002415 (海康威视)

**地产股：**
- 000002 (万科A)

## 📈 第二步：策略回测

### 2.1 启动回测器

运行策略回测脚本：

```bash
python strategy_backtester.py
```

### 2.2 回测选项

#### 选项1：单策略回测

**可用策略：**
- `double_ma`: 双均线策略
- `rsi`: RSI策略  
- `macd`: MACD策略

**操作步骤：**
1. 选择策略名称
2. 输入股票代码
3. 选择回测时间长度
4. 查看回测报告
5. 可选择绘制图表

**示例：**
```
策略名称: double_ma
股票代码: 000001
回测月数: 6
```

#### 选项2：策略参数优化

系统会自动测试不同的参数组合，找出最佳参数：

**双均线策略参数：**
- 短期均线：3, 5, 7, 10天
- 长期均线：15, 20, 25, 30天

**RSI策略参数：**
- RSI周期：10, 14, 18, 22天
- 超卖线：20, 25, 30, 35
- 超买线：65, 70, 75, 80

**MACD策略参数：**
- 快线：8, 12, 16天
- 慢线：20, 26, 32天
- 信号线：6, 9, 12天

#### 选项3：多策略比较

同时测试所有策略，比较它们的表现：
- 总收益率
- 年化收益率
- 夏普比率
- 最大回撤
- 胜率

## 📊 第三步：分析回测结果

### 3.1 关键指标解读

**收益指标：**
- **总收益率**：整个回测期间的总收益
- **年化收益率**：按年计算的收益率
- **超额收益**：相对于买入持有策略的超额收益

**风险指标：**
- **波动率**：收益的波动程度，越低越稳定
- **最大回撤**：最大的资产下跌幅度
- **夏普比率**：风险调整后的收益，>1.0为良好

**交易指标：**
- **胜率**：盈利交易占总交易的比例
- **交易次数**：总的买卖次数

### 3.2 策略评价标准

**优秀策略：**
- 夏普比率 > 1.5
- 最大回撤 < 5%
- 胜率 > 60%
- 年化收益 > 15%

**良好策略：**
- 夏普比率 > 1.0
- 最大回撤 < 10%
- 胜率 > 50%
- 年化收益 > 10%

**需要优化：**
- 夏普比率 < 0.5
- 最大回撤 > 15%
- 胜率 < 40%

### 3.3 图表分析

回测图表包含四个部分：

1. **资产价值曲线**：显示策略的资产增长情况
2. **回撤曲线**：显示资产的回撤情况
3. **现金与持仓分布**：显示资金配置情况
4. **性能指标表**：汇总所有关键指标

## 🔧 第四步：策略优化建议

### 4.1 双均线策略优化

**适用市场：**
- 趋势性较强的股票
- 波动较大的市场

**优化方向：**
- 调整均线周期组合
- 添加成交量确认
- 设置止损止盈

### 4.2 RSI策略优化

**适用市场：**
- 震荡市场
- 波动率适中的股票

**优化方向：**
- 调整超买超卖阈值
- 结合其他技术指标
- 优化持仓时间

### 4.3 MACD策略优化

**适用市场：**
- 中长期趋势明显
- 流动性好的大盘股

**优化方向：**
- 调整快慢线参数
- 添加背离判断
- 结合趋势过滤

## 💡 实用技巧

### 4.1 数据准备技巧

1. **选择合适的时间段**：
   - 牛市、熊市、震荡市都要包含
   - 至少6个月的数据
   - 避免特殊事件期间（如疫情初期）

2. **选择代表性股票**：
   - 不同行业的股票
   - 不同市值的股票
   - 流动性好的股票

### 4.2 回测技巧

1. **避免过度拟合**：
   - 不要过度优化参数
   - 使用样本外测试
   - 保持策略简单

2. **考虑交易成本**：
   - 手续费和印花税
   - 滑点成本
   - 冲击成本

3. **风险控制**：
   - 设置止损
   - 控制仓位
   - 分散投资

### 4.3 结果解读技巧

1. **不要只看收益**：
   - 关注风险指标
   - 考虑回撤情况
   - 分析交易频率

2. **对比基准**：
   - 与买入持有比较
   - 与市场指数比较
   - 与其他策略比较

## ⚠️ 注意事项

1. **历史表现不代表未来**：回测结果仅供参考
2. **市场环境变化**：策略需要根据市场调整
3. **数据质量**：确保使用高质量的历史数据
4. **实盘差异**：实盘交易会有额外的成本和限制
5. **风险控制**：始终把风险控制放在第一位

## 🚀 快速开始示例

### 完整流程示例：

```bash
# 1. 下载数据
python data_downloader.py
# 选择2 -> 下载热门股票 -> 输入6个月

# 2. 策略回测
python strategy_backtester.py
# 选择1 -> double_ma -> 000001 -> 6个月 -> 查看报告

# 3. 参数优化
python strategy_backtester.py
# 选择2 -> double_ma -> 000001 -> 6个月 -> 查看最佳参数

# 4. 策略比较
python strategy_backtester.py
# 选择3 -> 000001 -> 6个月 -> 比较所有策略
```

这样你就可以完整地体验从数据下载到策略回测的全流程了！

## 📞 获取帮助

如果在使用过程中遇到问题：
1. 查看日志文件了解错误信息
2. 确认数据是否正确下载
3. 检查股票代码格式是否正确
4. 在GitHub Issues中提问 